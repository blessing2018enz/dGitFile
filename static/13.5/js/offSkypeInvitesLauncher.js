!function(){"use strict";function a(){var a,b=[Object.keys,document.querySelectorAll,Array.prototype.indexOf,document.body.setAttribute,String.prototype.trim],c=void 0!==document.body.style.flex||void 0!==document.body.style.msFlex||void 0!==document.body.style.webkitBoxFlex;if(!1===c)return!1;for(a=0;a<b.length;a++)if(void 0===b[a])return!1;return!0}!1===a()&&(window.location.href="/unsupportedbrowser")}(),function(){"use strict";"undefined"==typeof SKYPE&&(window.SKYPE={}),SKYPE.login=SKYPE.login||{},SKYPE.login.Silent=function(){var a,b={pre:"https://prelogin.skype.net",qa:"https://qalogin.skype.net",live:"https://login.skype.com"},c="/login/silent",d="1.0",e=null,f={},g=null,h=null,i="",j=!1,k=!1,l=null,m={env:"live",client_id:null,redirect_uri:null,microsoft:!1},n=function(a,b){if(null===l&&(l=window.location.host.match(/^(pre|dev).*\.net$/)||document.cookie.indexOf("debug")>-1||window.location.search.indexOf("debug")>-1),l)try{if("object"==typeof b){var c=[];for(var d in b)"skypetoken"===d?c.push(d+": <HIDDEN>"):c.push(d+": "+JSON.stringify(b[d]));a+=" - "+c.join(", ")}else"string"==typeof b&&(a+=" - "+b);a="[silentlogin.js] - "+a,console.log(a)}catch(a){}},o=function(a){if(n("Received message from "+a.origin),h&&a.origin===h){var b=a.data;if("string"==typeof a.data)try{b=JSON.parse(a.data)}catch(a){}n("Message data",b);var c=b.state||null;if(i!==c)return void n("State "+c+" doesn't match the last submitted state "+i);window.clearTimeout(g),f={};for(var d in b)b.hasOwnProperty(d)&&(f[d]=b[d]);t()}},p=function(a){q(),e=document.createElement("iframe"),e.frameBorder=0,e.width="1px",e.height="1px",e.id="silentLoginFrame"+Math.floor(10*Math.random()+1),e.setAttribute("src",a),document.body.appendChild(e),n("Created iFrame: "+a)},q=function(){e&&(document.body.removeChild(e),e=null)},r=function(){if(!m.client_id)throw"[silentlogin.js] client_id not initialized. Call init() first.";m.redirect_uri||(m.redirect_uri=window.location.protocol+"//"+window.location.host+window.location.pathname)},s=function(){return"postMessage"in window&&"object"==typeof JSON&&JSON.parse},t=function(){n("Calling callback function",f),k=!1,"function"==typeof a&&a(f)},u=function(){q(),f={},f.error="timeout",t()},v=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},w=function(){var a=(new Date).getTime();h=b[m.env]||b.live,i="silentloginsdk_"+a;var e={response_type:"postmessage",client_id:m.client_id,redirect_uri:m.redirect_uri,state:i,_accept:d,_nc:a};return m.microsoft&&(e.partner="999"),h+c+"?"+v(e)},x=function(a){if("object"==typeof a){a=a||{},a.hasOwnProperty("callback")&&y(a.callback);for(var b in m)a.hasOwnProperty(b)&&(m[b]=a[b])}return j||(j=!0,window.addEventListener?window.addEventListener("message",o,!1):window.attachEvent("onmessage",o)),this},y=function(b){return"function"==typeof b&&(a=b),this};return{init:x,setCallback:y,load:function(){if(!k){if(r(),k=!0,!s())return f={error:"unsupported_browser"},void t();window.clearTimeout(g),g=window.setTimeout(u,2e4),p(w())}},getSkypetoken:function(){return f.skypetoken||null},getFullResponse:function(){return f}}}()}();var clienttelemetry_build;!function(a){a.version="2.1.2"}(clienttelemetry_build||(clienttelemetry_build={}));var Microsoft;!function(a){!function(a){!function(a){a[a.BT_STOP=0]="BT_STOP",a[a.BT_STOP_BASE=1]="BT_STOP_BASE",a[a.BT_BOOL=2]="BT_BOOL",a[a.BT_UINT8=3]="BT_UINT8",a[a.BT_UINT16=4]="BT_UINT16",a[a.BT_UINT32=5]="BT_UINT32",a[a.BT_UINT64=6]="BT_UINT64",a[a.BT_FLOAT=7]="BT_FLOAT",a[a.BT_DOUBLE=8]="BT_DOUBLE",a[a.BT_STRING=9]="BT_STRING",a[a.BT_STRUCT=10]="BT_STRUCT",a[a.BT_LIST=11]="BT_LIST",a[a.BT_SET=12]="BT_SET",a[a.BT_MAP=13]="BT_MAP",a[a.BT_INT8=14]="BT_INT8",a[a.BT_INT16=15]="BT_INT16",a[a.BT_INT32=16]="BT_INT32",a[a.BT_INT64=17]="BT_INT64",a[a.BT_WSTRING=18]="BT_WSTRING",a[a.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(a.BondDataType||(a.BondDataType={})),a.BondDataType,function(a){a[a.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",a[a.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",a[a.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",a[a.JSON_PROTOCOL=21322]="JSON_PROTOCOL",a[a.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",a[a.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(a.ProtocolType||(a.ProtocolType={})),a.ProtocolType}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var Microsoft;!function(a){!function(a){!function(a){var b=function(){function a(){this._buffer=[]}return a.prototype.Add=function(a){for(var b=0;b<this._buffer.length&&this._buffer[b]!=a;++b);b==this._buffer.length&&this._buffer.push(a)},a.prototype.Count=function(){return this._buffer.length},a.prototype.GetBuffer=function(){return this._buffer},a}();a.Set=b;var c=function(){function a(){this._buffer=[]}return a.prototype.Add=function(a,b){-1==this._getIndex(a)&&this._buffer.push({Key:a,Value:b})},a.prototype.AddOrReplace=function(a,b){var c=this._getIndex(a);c>=0?this._buffer[c]={Key:a,Value:b}:this._buffer.push({Key:a,Value:b})},a.prototype.Remove=function(a){var b=this._getIndex(a);b>=0&&this._buffer.splice(b,1)},a.prototype.Count=function(){return this._buffer.length},a.prototype.GetBuffer=function(){return this._buffer},a.prototype._getIndex=function(a){for(var b=0,c=-1;b<this._buffer.length;++b)if(this._buffer[b].Key==a){c=b;break}return c},a}();a.Map=c}(a.Collections||(a.Collections={})),a.Collections}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var Microsoft;!function(a){!function(b){!function(a){var d=function(){function a(){}return a.GetBytes=function(a){for(var b=[],c=0;c<a.length;++c){var d=a.charCodeAt(c);128>d?b.push(d):2048>d?b.push(192|d>>6,128|63&d):55296>d||d>=57344?b.push(224|d>>12,128|d>>6&63,128|63&d):(d=65536+((1023&d)<<10|1023&a.charCodeAt(++c)),b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d))}return b},a}();a.Utf8=d;var e=function(){function a(){}return a.GetString=function(a){var b,c,d,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=[],g=a.length%3,h=function(a){return[e.charAt(a>>18&63),e.charAt(a>>12&63),e.charAt(a>>6&63),e.charAt(63&a)].join("")};for(b=0,d=a.length-g;d>b;b+=3)c=(a[b]<<16)+(a[b+1]<<8)+a[b+2],f.push(h(c));switch(g){case 1:c=a[a.length-1],f.push(e.charAt(c>>2)),f.push(e.charAt(c<<4&63)),f.push("==");break;case 2:c=(a[a.length-2]<<8)+a[a.length-1],f.push(e.charAt(c>>10)),f.push(e.charAt(c>>4&63)),f.push(e.charAt(c<<2&63)),f.push("=")}return f.join("")},a}();a.Base64=e;var f=function(){function a(){}return a.GetBytes=function(a){for(var b=[];4294967168&a;)b.push(127&a|128),a>>>=7;return b.push(127&a),b},a}();a.Varint=f;var g=function(){function a(){}return a.GetBytes=function(a){for(var b=a.low,c=a.high,d=[];c||4294967168&b;)d.push(127&b|128),b=(127&c)<<25|b>>>7,c>>>=7;return d.push(127&b),d},a}();a.Varint64=g;var h=function(){function a(){}return a.GetBytes=function(a){if(b.BrowserChecker.IsDataViewSupport()){var d=new DataView(new ArrayBuffer(4));d.setFloat32(0,a,!0);for(var e=[],f=0;4>f;++f)e.push(d.getUint8(f));return e}return c.ConvertNumberToArray(a,!1)},a}();a.Float=h;var i=function(){function a(){}return a.GetBytes=function(a){if(b.BrowserChecker.IsDataViewSupport()){var d=new DataView(new ArrayBuffer(8));d.setFloat64(0,a,!0);for(var e=[],f=0;8>f;++f)e.push(d.getUint8(f));return e}return c.ConvertNumberToArray(a,!0)},a}();a.Double=i;var j=function(){function a(){}return a.EncodeZigzag16=function(a){return(a=b.Number.ToInt16(a))<<1^a>>15},a.EncodeZigzag32=function(a){return(a=b.Number.ToInt32(a))<<1^a>>31},a.EncodeZigzag64=function(a){var c=a.low,d=a.high,e=d<<1|c>>>31,f=c<<1;2147483648&d&&(e=~e,f=~f);var g=new b.UInt64("0");return g.low=f,g.high=e,g},a}();a.Zigzag=j}(b.Encoding||(b.Encoding={})),b.Encoding,function(d){var e=function(){function a(){}return a.GetString=function(a){for(var b=[],c=0;c<a.length;++c){var d=a[c];if(191>=d)b.push(String.fromCharCode(d));else if(223>=d){var e=a[++c];b.push(String.fromCharCode((31&d)<<6|63&e))}else if(239>=d){var e=a[++c],f=a[++c];b.push(String.fromCharCode((15&d)<<12|(63&e)<<6|63&f))}else{var e=a[++c],f=a[++c],g=a[++c];d=(7&d)<<18|(63&e)<<12|(63&f)<<6|63&g,d-=65536,b.push(String.fromCharCode(55296|d>>10&1023)),b.push(String.fromCharCode(56320|1023&d))}}return b.join("")},a}();d.Utf8=e;var f=function(){function a(){}return a.GetBytes=function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=[],d=0;d<a.length;++d){var e=b.indexOf(a.charAt(d++)),f=b.indexOf(a.charAt(d++)),g=b.indexOf(a.charAt(d++)),h=b.indexOf(a.charAt(d));c.push(e<<2|f>>4),g>=0&&(c.push(f<<4&240|g>>2),h>=0&&c.push(g<<6&192|h))}return c},a}();d.Base64=f;var g=function(){function b(){}return b.GetInt64=function(b){var c=new a.Bond.Int64("0"),d=this._Read(b);return c.low=d[0],d.length>1&&(c.high=d[1]),c},b.GetNumber=function(a){return this._Read(a)[0]},b._Read=function(a){for(var b=[],c=0,d=!0,e=0;d;){var f=a.shift();if(d=0!=(128&f),f&=127,!(28>e)){c|=f<<e,b.push(c),c=f>>4,e=3;break}c|=f<<e,e+=7}for(;d;){var f=a.shift();if(d=0!=(128&f),f&=127,c|=f<<e,(e+=7)>=32)break}return b.push(c),b},b}();d.Varint=g;var h=function(){function a(){}return a.GetNumber=function(a){if(b.BrowserChecker.IsDataViewSupport()){for(var d=new DataView(new ArrayBuffer(4)),e=0;4>e;++e)d.setUint8(e,a[e]);return d.getFloat32(0,!0)}return c.ConvertArrayToNumber(a,!1)},a}();d.Float=h;var i=function(){function a(){}return a.GetNumber=function(a){if(b.BrowserChecker.IsDataViewSupport()){for(var d=new DataView(new ArrayBuffer(8)),e=0;8>e;++e)d.setUint8(e,a[e]);return d.getFloat64(0,!0)}return c.ConvertArrayToNumber(a,!0)},a}();d.Double=i;var j=function(){function b(){}return b.DecodeZigzag16=function(a){return((65535&a)>>>1^-(1&a))<<16>>16},b.DecodeZigzag32=function(a){return a>>>1^-(1&a)},b.DecodeZigzag64=function(b){var c=1&b.high,d=b.high>>>1,e=1&b.low,f=b.low>>>1;f|=c<<31,e&&(f^=4294967295,d^=4294967295);var g=new a.Bond.UInt64("0");return g.low=f,g.high=d,g},b}();d.Zigzag=j}(b.Decoding||(b.Decoding={}));var c=(b.Decoding,function(){function a(){}return a.ConvertNumberToArray=function(a,b){if(!a)return b?this._doubleZero:this._floatZero;var c=b?11:8,d=b?52:23,e=(1<<c-1)-1,f=1-e,g=e,h=0>a?1:0;a=Math.abs(a);for(var i=Math.floor(a),j=a-i,k=2*(e+2)+d,l=new Array(k),m=0;k>m;)l[m++]=0;for(m=e+2;m&&i;)l[--m]=i%2,i=Math.floor(i/2);for(m=e+1;k-1>m&&j>0;)j*=2,j>=1?(l[++m]=1,--j):l[++m]=0;for(var n=0;k>n&&!l[n];++n);var o=e+1-n,p=n+d;if(l[p+1]){for(m=p;m>n&&!(l[m]=1-l[m]);--m);m==n&&++o}if(o>g||i)return h?b?this._doubleNegInifinity:this._floatNegInifinity:b?this._doubleInifinity:this._floatInifinity;if(f>o)return b?this._doubleZero:this._floatZero;if(b){var q=0;for(m=0;20>m;++m)q=q<<1|l[++n];for(var r=0;52>m;++m)r=r<<1|l[++n];q|=o+e<<20,q=h<<31|2147483647&q;var s=[255&r,r>>8&255,r>>16&255,r>>>24,255&q,q>>8&255,q>>16&255,q>>>24];return s}var t=0;for(m=0;23>m;++m)t=t<<1|l[++n];t|=o+e<<23,t=h<<31|2147483647&t;var s=[255&t,t>>8&255,t>>16&255,t>>>24];return s},a.ConvertArrayToNumber=function(a,c){var d=c?11:8,e=(1<<d-1)-1,f=0!=(128&a[c?7:3]),g=c?(127&a[7])<<4|(240&a[6])>>4:(127&a[3])<<1|(128&a[2])>>7;if(255==g)throw new b.Exception("Not a valid float/double buffer.");var h=1,i=1;if(c){var j=(15&a[6])<<28|(255&a[5])<<20|(255&a[4])<<12,k=a[3]<<24|(255&a[2])<<16|(255&a[1])<<8|255&a[0];if(!g&&!j&&!k)return 0;for(var l=0;20>l;++l)i/=2,0>j&&(h+=i),j<<=1;for(var l=0;32>l;++l)i/=2,0>k&&(h+=i),k<<=1}else{var m=(127&a[2])<<25|(255&a[1])<<17|(255&a[0])<<9;if(!g&&!m)return 0;for(var l=0;23>l;++l)i/=2,0>m&&(h+=i),m<<=1}return h*=Math.pow(2,g-e),f?0-h:h},a._floatZero=[0,0,0,0],a._doubleZero=[0,0,0,0,0,0,0,0],a._floatInifinity=[0,0,128,127],a._floatNegInifinity=[0,0,128,255],a._doubleInifinity=[0,0,0,0,0,0,240,127],a._doubleNegInifinity=[0,0,0,0,0,0,240,255],a}())}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var Microsoft;!function(a){!function(a){!function(b){var c=function(){function b(){this._buffer=[]}return b.prototype.WriteByte=function(b){this._buffer.push(a.Number.ToByte(b))},b.prototype.Write=function(a,b,c){for(;c--;)this.WriteByte(a[b++])},b.prototype.GetBuffer=function(){return this._buffer},b}();b.MemoryStream=c}(a.IO||(a.IO={})),a.IO}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var Microsoft;!function(a){!function(a){var b=function(){function a(a,b){this.Type=a,this.Id=b}return a}();a.FieldTag=b;var c=function(){function a(a,b){this.ElementType=a,this.Size=b}return a}();a.ContainerTag=c;var d=function(){function a(a,b,c){this.KeyType=a,this.ValueType=b,this.Size=c}return a}();a.KeyValueContainerTag=d;var e=function(){function a(){}return a}();a.Bonded=e;var f=function(){function a(a){this.low=0,this.high=0,this.low=parseInt(a),this.low<0&&(this.high=-1)}return a.prototype.Equals=function(b){var c=new a(b);return this.low==c.low&&this.high==c.high},a}();a.Int64=f;var g=function(){function a(a){this.low=0,this.high=0,this.low=parseInt(a)}return a.prototype.Equals=function(b){var c=new a(b);return this.low==c.low&&this.high==c.high},a}();a.UInt64=g;var h=function(){function a(){}return a.ToByte=function(a){return this.ToUInt8(a)},a.ToInt8=function(a){return 127&a|(128&a)<<24>>24},a.ToInt16=function(a){return 32767&a|(32768&a)<<16>>16},a.ToInt32=function(a){return 2147483647&a|2147483648&a},a.ToUInt8=function(a){return 255&a},a.ToUInt16=function(a){return 65535&a},a.ToUInt32=function(a){return 4294967295&a},a}();a.Number=h;var i=function(){function a(a){this.Message=a}return a}();a.Exception=i;var j=function(){function a(){}return a}();a.KeyValuePair=j;var k=function(){function a(){}return a.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},a}();a.BrowserChecker=k}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var Microsoft;!function(a){!function(a){var b=function(){function b(a){this._stream=a}return b.prototype.WriteBlob=function(a){this._stream.Write(a,0,a.length)},b.prototype.WriteBool=function(a){this._stream.WriteByte(a?1:0)},b.prototype.WriteContainerBegin=function(a,b){this.WriteUInt8(b),this.WriteUInt32(a)},b.prototype.WriteMapContainerBegin=function(a,b,c){this.WriteUInt8(b),this.WriteUInt8(c),this.WriteUInt32(a)},b.prototype.WriteContainerEnd=function(){},b.prototype.WriteDouble=function(b){var c=a.Encoding.Double.GetBytes(b);this._stream.Write(c,0,c.length)},b.prototype.WriteFloat=function(b){var c=a.Encoding.Float.GetBytes(b);this._stream.Write(c,0,c.length)},b.prototype.WriteFieldBegin=function(a,b,c){5>=b?this._stream.WriteByte(a|b<<5):255>=b?(this._stream.WriteByte(192|a),this._stream.WriteByte(b)):(this._stream.WriteByte(224|a),this._stream.WriteByte(b),this._stream.WriteByte(b>>8))},b.prototype.WriteFieldEnd=function(){},b.prototype.WriteFieldOmitted=function(a,b,c){},b.prototype.WriteInt16=function(b){b=a.Encoding.Zigzag.EncodeZigzag16(b),this.WriteUInt16(b)},b.prototype.WriteInt32=function(b){b=a.Encoding.Zigzag.EncodeZigzag32(b),this.WriteUInt32(b)},b.prototype.WriteInt64=function(b){this.WriteUInt64(a.Encoding.Zigzag.EncodeZigzag64(b))},b.prototype.WriteInt8=function(b){this._stream.WriteByte(a.Number.ToInt8(b))},b.prototype.WriteString=function(b){if(""==b)this.WriteUInt32(0);else{var c=a.Encoding.Utf8.GetBytes(b);this.WriteUInt32(c.length),this._stream.Write(c,0,c.length)}},b.prototype.WriteStructBegin=function(a,b){},b.prototype.WriteStructEnd=function(a){this.WriteUInt8(a?1:0)},b.prototype.WriteUInt16=function(b){var c=a.Encoding.Varint.GetBytes(a.Number.ToUInt16(b));this._stream.Write(c,0,c.length)},b.prototype.WriteUInt32=function(b){var c=a.Encoding.Varint.GetBytes(a.Number.ToUInt32(b));this._stream.Write(c,0,c.length)},b.prototype.WriteUInt64=function(b){var c=a.Encoding.Varint64.GetBytes(b);this._stream.Write(c,0,c.length)},b.prototype.WriteUInt8=function(b){this._stream.WriteByte(a.Number.ToUInt8(b))},b.prototype.WriteWString=function(a){this.WriteUInt32(a.length);for(var b=0;b<a.length;++b){var c=a.charCodeAt(b);this._stream.WriteByte(c),this._stream.WriteByte(c>>>8)}},b}();a.CompactBinaryProtocolWriter=b;var c=function(){function a(){}return a}();a.CompactBinaryProtocolReader=c}(a.Bond||(a.Bond={})),a.Bond}(Microsoft||(Microsoft={}));var sct;!function(a){var b=function(){function a(){}return a.IsSafari=function(){return null===a._isSafari&&a._DetectBrowser(),a._isSafari},a.ajax=function(b){var c=a._createConnection();if(!c.setRequestHeader&&b.headers){var d="read-from-query-string-instead-of-headers=true";for(var e in b.headers)d+="&",d+=encodeURIComponent(e),d+="=",d+=encodeURIComponent(b.headers[e]);b.url+=b.url.indexOf("?")<0?"?":"&",b.url+=d}if(c.open(b.type,b.url),c.setRequestHeader&&b.headers)for(var e in b.headers)c.setRequestHeader(e,b.headers[e]);b.complete&&(c.onload=function(){void 0===c.status&&(c.status=200),b.complete(c)},c.ontimeout=function(){void 0===c.status&&(c.status=500),b.complete(c)},c.onerror=function(){b.complete(c)}),c.send(b.data)},a.keys=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},a.IsUsingXDomainRequest=function(){if(null==a._usingXDomainRequest){var b=new XMLHttpRequest;a._usingXDomainRequest=void 0===b.withCredentials&&"undefined"!=typeof XDomainRequest}return a._usingXDomainRequest},a._createConnection=function(){var b=new XMLHttpRequest;return a.IsUsingXDomainRequest()?new XDomainRequest:b},a._DetectBrowser=function(){var b=navigator.userAgent.toLowerCase();a._isSafari=b.indexOf("safari")>=0&&b.indexOf("chrome")<0},a._isSafari=null,a._usingXDomainRequest=null,a}();a.Utils=b}(sct||(sct={}));var microsoft;!function(a){!function(a){!function(a){!function(b){var c=function(){function a(){}return a.GetGuid=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[a(),a(),"-",a(),a(),"-",a(),"-",a(),a()].join("")},a.GetTimeStamp=function(){var a=(new Date).getTime(),b=new Microsoft.Bond.Int64("0");return b.low=4294967295&a,b.high=Math.floor(a/4294967296),b},a.GetTimeStampWithValue=function(a){var b=new Microsoft.Bond.Int64("0");return b.low=4294967295&a,b.high=Math.floor(a/4294967296),b},a}();b.utils=c,function(a){a[a.NotSet=0]="NotSet",a[a.Event=1]="Event",a[a.PerformanceCounter=2]="PerformanceCounter",a[a.Anomaly=3]="Anomaly",a[a.Prediction=4]="Prediction",a[a.TraceLog=5]="TraceLog",a[a.EventSourceLog=6]="EventSourceLog",a[a.HttpLog=7]="HttpLog",a[a.PerformanceCounterAzure=8]="PerformanceCounterAzure",a[a.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(b.RecordType||(b.RecordType={})),b.RecordType,function(a){a[a.NotSet=0]="NotSet",a[a.O365=1]="O365",a[a.SkypeBI=2]="SkypeBI",a[a.SkypeData=3]="SkypeData"}(b.PIIScrubber||(b.PIIScrubber={})),b.PIIScrubber,function(a){a[a.NotSet=0]="NotSet",a[a.DistinguishedName=1]="DistinguishedName",a[a.GenericData=2]="GenericData",a[a.IPV4Address=3]="IPV4Address",a[a.IPv6Address=4]="IPv6Address",a[a.MailSubject=5]="MailSubject",a[a.PhoneNumber=6]="PhoneNumber",a[a.QueryString=7]="QueryString",a[a.SipAddress=8]="SipAddress",a[a.SmtpAddress=9]="SmtpAddress",a[a.Identity=10]="Identity",a[a.Uri=11]="Uri",a[a.Fqdn=12]="Fqdn",a[a.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(b.PIIKind||(b.PIIKind={}));var d=(b.PIIKind,function(){function a(){this.ScrubType=0,this.Kind=0,this.RawContent=""}return a.prototype.Write=function(a){this.WriteImpl(a,!1)},a.prototype.WriteImpl=function(a,b){a.WriteStructBegin(null,b),0!=this.ScrubType?(a.WriteFieldBegin(16,1,null),a.WriteInt32(this.ScrubType),a.WriteFieldEnd()):a.WriteFieldOmitted(16,1,null),0!=this.Kind?(a.WriteFieldBegin(16,2,null),a.WriteInt32(this.Kind),a.WriteFieldEnd()):a.WriteFieldOmitted(16,2,null),""!=this.RawContent?(a.WriteFieldBegin(9,3,null),a.WriteString(this.RawContent),a.WriteFieldEnd()):a.WriteFieldOmitted(9,3,null),a.WriteStructEnd(b)},a.prototype.Read=function(a){this.ReadImpl(a,!1)},a.prototype.ReadImpl=function(a,b){},a}());b.PII=d;var e=function(){function b(){this.Id=c.GetGuid(),this.Timestamp=c.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=0,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return b.prototype.AddOrReplacePII=function(b,c,d){var e=new a.datamodels.PII;e.RawContent=c,e.Kind=d,e.ScrubType=1,this.PIIExtensions.AddOrReplace(b,e)},b.prototype.Write=function(a){this.WriteImpl(a,!1)},b.prototype.WriteImpl=function(a,b){if(a.WriteStructBegin(null,b),""!=this.Id?(a.WriteFieldBegin(9,1,null),a.WriteString(this.Id),a.WriteFieldEnd()):a.WriteFieldOmitted(9,1,null),this.Timestamp.Equals("0")?a.WriteFieldOmitted(17,3,null):(a.WriteFieldBegin(17,3,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd()),""!=this.Type?(a.WriteFieldBegin(9,5,null),a.WriteString(this.Type),a.WriteFieldEnd()):a.WriteFieldOmitted(9,5,null),""!=this.EventType?(a.WriteFieldBegin(9,6,null),a.WriteString(this.EventType),a.WriteFieldEnd()):a.WriteFieldOmitted(9,6,null),this.Extension.Count()){a.WriteFieldBegin(13,13,null),a.WriteMapContainerBegin(this.Extension.Count(),9,9);for(var c=0;c<this.Extension.GetBuffer().length;++c)a.WriteString(this.Extension.GetBuffer()[c].Key),a.WriteString(this.Extension.GetBuffer()[c].Value);a.WriteContainerEnd(),a.WriteFieldEnd()}else a.WriteFieldOmitted(13,13,null);if(0!=this.RecordType?(a.WriteFieldBegin(16,24,null),a.WriteInt32(this.RecordType),a.WriteFieldEnd()):a.WriteFieldOmitted(16,24,null),this.PIIExtensions.Count()){a.WriteFieldBegin(13,30,null),a.WriteMapContainerBegin(this.PIIExtensions.Count(),9,10);for(var d=0;d<this.PIIExtensions.GetBuffer().length;++d)a.WriteString(this.PIIExtensions.GetBuffer()[d].Key),this.PIIExtensions.GetBuffer()[d].Value.WriteImpl(a,!1);a.WriteContainerEnd(),a.WriteFieldEnd()}else a.WriteFieldOmitted(13,30,null);a.WriteStructEnd(b)},b.prototype.Read=function(a){this.ReadImpl(a,!1)},b.prototype.ReadImpl=function(a,b){},b}();b.Record=e;var f=function(){function a(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return a.prototype.Write=function(a){this.WriteImpl(a,!1)},a.prototype.WriteImpl=function(a,b){if(a.WriteStructBegin(null,b),""!=this.Source?(a.WriteFieldBegin(9,2,null),a.WriteString(this.Source),a.WriteFieldEnd()):a.WriteFieldOmitted(9,2,null),""!=this.DataPackageId?(a.WriteFieldBegin(9,5,null),a.WriteString(this.DataPackageId),a.WriteFieldEnd()):a.WriteFieldOmitted(9,5,null),this.Timestamp.Equals("0")?a.WriteFieldOmitted(17,6,null):(a.WriteFieldBegin(17,6,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd()),this.Records.length){a.WriteFieldBegin(11,8,null),a.WriteContainerBegin(this.Records.length,10);for(var c=0;c<this.Records.length;++c)this.Records[c].WriteImpl(a,!1);a.WriteContainerEnd(),a.WriteFieldEnd()}else a.WriteFieldOmitted(11,8,null);a.WriteStructEnd(b)},a.prototype.Read=function(a){this.ReadImpl(a,!1)},a.prototype.ReadImpl=function(a,b){},a}();b.DataPackage=f;var g=function(){function a(){this.DataPackages=[],this.RequestRetryCount=0}return a.prototype.Write=function(a){this.WriteImpl(a,!1)},a.prototype.WriteImpl=function(a,b){if(a.WriteStructBegin(null,b),this.DataPackages.length){a.WriteFieldBegin(11,1,null),a.WriteContainerBegin(this.DataPackages.length,10);for(var c=0;c<this.DataPackages.length;++c)this.DataPackages[c].WriteImpl(a,!1);a.WriteContainerEnd(),a.WriteFieldEnd()}else a.WriteFieldOmitted(11,1,null);0!=this.RequestRetryCount?(a.WriteFieldBegin(16,2,null),a.WriteInt32(this.RequestRetryCount),a.WriteFieldEnd()):a.WriteFieldOmitted(16,2,null),a.WriteStructEnd(b)},a.prototype.Read=function(a){this.ReadImpl(a,!1)},a.prototype.ReadImpl=function(a,b){},a}();b.ClientToCollectorRequest=g}(a.datamodels||(a.datamodels={})),a.datamodels}(a.telemetry||(a.telemetry={})),a.telemetry}(a.applications||(a.applications={})),a.applications}(microsoft||(microsoft={}));var microsoft;!function(a){!function(a){!function(a){!function(b){!function(a){a[a.SENT=0]="SENT",a[a.SEND_FAILED=1]="SEND_FAILED"}(b.CallbackEventType||(b.CallbackEventType={})),b.CallbackEventType,function(a){a[a.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",a[a.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",a[a.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",a[a.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",a[a.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",a[a.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(b.DATARV_ERROR||(b.DATARV_ERROR={}));var c=(b.DATARV_ERROR,function(){function a(a){this._errorCode=0,this._errorCode=a}return a.prototype.ErrorCode=function(){return this._errorCode},a.prototype.toString=function(){switch(this._errorCode){case 0:return"DATARV_ERROR_OK";case 1:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case 2:return"Invalid configuration. CollectorUrl is missing.";case 3:return"DATARV_ERROR_INVALID_DEPENDENCIES";case 4:return"Telemetry Manager is not initialized.";case 5:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},a}());b.Exception=c;var d=function(){function a(){}return a}();b.TelemetryConfig=d;var e=function(){function a(){}return a.CreateTelemetryManager=function(){return new h},a}();b.TelemetryManagerFactory=e;var f,g=function(){function a(){}return a.MaxPackageSizeInBytes=function(){return 3e6},a.TimeIntervalForNextSendInMS=function(){return 2e3},a}();!function(a){a[a.Created=0]="Created",a[a.Initialized=1]="Initialized",a[a.Started=2]="Started"}(f||(f={}));var h=function(){function b(){this._MaxPackageSizeInBytes=g.MaxPackageSizeInBytes(),this._listeners=[],this._status=0,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null}return b.prototype.Initialize=function(a){if(0!=this._status)throw new c(4);if(!a||!a.collectorUrl)throw new c(2);this._config=a,this._Reset(),this._status=1,a.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=a.ecsClient),this._Verbose("Initialize() done")},b.prototype.AddListener=function(a){if(this._status<1)throw new c(4);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=0;b<this._listeners.length;++b)if(this._listeners[b]==a)return void this._Verbose("the listener has been added already, index: "+b);this._listeners.push(a),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},b.prototype.RemoveListener=function(a){if(this._status<1)throw new c(4);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=0;b<this._listeners.length;++b)if(this._listeners[b]==a)return 1==this._listeners.length?this._listeners=[]:b==this._listeners.length-1?this._listeners.pop():this._listeners[b]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",b,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},b.prototype.Start=function(){if(this._status<1)throw new c(4);this._Verbose(["Start(), status:",this._status,"tag:",b._tag].join(" ")),this._status>=2&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++b._tag,this._status=2,this._Verbose(["Start() done, status: ",this._status,"tag: ",b._tag].join(""))},b.prototype.Stop=function(){if(this._status<1)throw new c(4);return this._Verbose("Stop(), status: "+this._status),1==this._status?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=1,void this._Verbose("Stop() done, status: "+this._status))},b.prototype.SendAsync=function(a,d){if(this._status<1)throw new c(4);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",a,"count:",d.length].join(" ")),this._status<2)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!a||!d)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new c(5);for(var e=0;e<d.length;++e)if(!d[e].Id||!b._eventTypeRegex.test(d[e].EventType)||d[e].Timestamp.Equals("0"))throw this._Error(["eventId:",d[e].Id,"eventType:",d[e].EventType,"timestamp high:",d[e].Timestamp.high,"timestamp low:",d[e].Timestamp.low].join("")),new c(1);return this._eventsCache.AddEvents(a,d),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},b.prototype._WorkThread=function(){var a=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<2)return void this._Verbose("_WorkThread, status is not started, return");var c=this._eventsCache.DequeuEvents();if(null==c)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var d=this._PackEvents(c.tenantToken,c.events);if(this._eventsCache.AddEvents(c.tenantToken,d.remainedEvents),this._testServerResponseHook){var e=this._testServerResponseHook();return void setTimeout(this._SendCallback(g,c.tenantToken,d.sendEvents,e),100)}var f={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","Client-ID":"NO_AUTH"},complete:function(b){return a._SendCallback(g,c.tenantToken,d.sendEvents,b)}};sct.Utils.IsSafari()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),f.data=Microsoft.Bond.Encoding.Base64.GetString(d.buffer),f.headers={"content-type":"application/bond-compact-binary","content-encoding":"base64","Client-ID":"NO_AUTH"}):(this._Verbose("Uint8Array is defined, send with binary format directly."),f.data=new Uint8Array(d.buffer)),c.tenantToken&&(f.headers["x-apikey"]=c.tenantToken);var g=b._tag;this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(f),this._Verbose("_Workthread, send via jquery, tag: "+g)}catch(a){this._Error("_WorkThread, exception: "+a)}},b.prototype._PackEvents=function(b,c){this._Verbose("_PackageEvents, total Count: "+c.length);var d=new a.datamodels.ClientToCollectorRequest,e=new a.datamodels.DataPackage;e.Source="JS_default_source",e.DataPackageId=a.datamodels.utils.GetGuid(),e.Timestamp=a.datamodels.utils.GetTimeStamp();var f,g=c;for(c=[];e.Records=[],e.Records.push.apply(e.Records,g),d.DataPackages=[],d.DataPackages.push(e),f=this._Serialize(d),this._Verbose(["_PackageEvents, sendEvents.length:",g.length,"buffer.length:",f.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(1==g.length||f.length<this._MaxPackageSizeInBytes);){var h=g.splice(0,Math.floor(g.length/2));this._Verbose("_PackageEvents, too large, package again"),c.push.apply(c,g),g=h}return this._Verbose(["_PakcageEvents done, sendEventsCount:",g.length,"buffer.length:",f.length,"remained events:",c.length].join("")),{buffer:f,sendEvents:g,remainedEvents:c}},b.prototype._Serialize=function(a){var b=new Microsoft.Bond.IO.MemoryStream,c=new Microsoft.Bond.CompactBinaryProtocolWriter(b);return a.Write(c),b.GetBuffer()},b.prototype._SendCallback=function(a,c,d,e){this._Verbose(["_SendCallback","tag:",a,"current tag:",b._tag,"tenantToken:",c,"events count:",d.length,"jqXHR:",e].join(""));var f=null!=e&&e.status>=200&&e.status<300;if(this._status<2||a<b._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!f&&(!e||e.status&&400!=e.status))return this._Verbose("retry statusCode: "+(e?e.status:0)),this._eventsCache.AddEvents(c,d),void this._ScheduleTimer(!0);for(var g=0;g<this._listeners.length;++g)this._listeners[g](f?0:1,e?e.status:0,c,d);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))},b.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},b.prototype._ScheduleTimer=function(a){var b=this;if(this._Verbose("_ScheduleTimer: isRetry: "+a),this._CleanTimer(),a){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var c=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=1e3*setTimeout(function(){return b._WorkThread()},c),this._Verbose("_ScheduleTimer, next try (s): "+c),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var c=0,d=(new Date).getTime(),e=d-this._lastActiveTime;c=e>g.TimeIntervalForNextSendInMS()?0:g.TimeIntervalForNextSendInMS()-e,this._timer=setTimeout(function(){return b._WorkThread()},c),this._Verbose("_ScheduleTimer, next try: "+c),this._rescheduleFactor=1}},b.prototype._Verbose=function(a){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+a)},b.prototype._Info=function(a){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+a)},b.prototype._Error=function(a){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+a)},b.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new i,this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)},b.prototype._CreateEcsCallback=function(){var a=this;return function(b){0==b&&(a._etag=a._ecsClient.GetETag())}},b.prototype.__GetListenerArray=function(){return this._listeners},b.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},b.prototype.__IsScheduled=function(){return null!=this._timer},b.prototype.__ChageMaxPackageSizeInKB=function(a){this._MaxPackageSizeInBytes=1024*a},b.prototype.__SetTestServerResponseHook=function(a){this._testServerResponseHook=a},b._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,b._tag=0,b}(),i=function(){function a(){this._events={},this._tokens=[]}return a.prototype.AddEvents=function(a,b){b.length&&(this._events[a]||(this._events[a]=[],this._tokens.push(a)),this._events[a].push.apply(this._events[a],b))},a.prototype.IsEmpty=function(){return 0==this._tokens.length},a.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var a=this._tokens.shift(),b=this._events[a];return delete this._events[a],{tenantToken:a,events:b}},a.prototype.GetTotalEventsCount=function(){var a=0;for(var b in this._events)a+=this._events[b].length;return a},a}()}(a._sender||(a._sender={})),a._sender}(a.telemetry||(a.telemetry={})),a.telemetry}(a.applications||(a.applications={})),a.applications}(microsoft||(microsoft={}));var microsoft;!function(a){!function(a){!function(a){var b=a._sender.TelemetryManagerFactory.CreateTelemetryManager(),c=function(){function c(){}return c.initialize=function(a){if(!this._initialized){if(!a)throw new g(1);this._defaultToken=a,this._config.collectorUrl||(this._config.collectorUrl="https://pipe.skype.com/Collector/3.0/"),b.Initialize(this._config),b.Start(),this._initialized=!0}},c.addCallbackListener=function(a){this._initialized&&b.AddListener(a)},c.isInitialized=function(){return this._initialized},c.getDefaultToken=function(){return this._defaultToken},c.__setCollectorUrlToInt=function(){this._config.collectorUrl="https://pipe.int.trafficmanager.net/Collector/3.0/"},c.__backToUninitialized=function(){this._config=new a._sender.TelemetryConfig,b=a._sender.TelemetryManagerFactory.CreateTelemetryManager(),this._initialized=!1},c._initialized=!1,c._defaultToken=null,c._config=new a._sender.TelemetryConfig,c}();a.LogManager=c;var d=function(){function d(b){this._initId=a.datamodels.utils.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new e,this._tenantToken=b||c.getDefaultToken()}return d.prototype.logEvent=function(a){if(c.isInitialized()){if(!a.name)throw new g(2);var b=this._createEventRecord(a.name,"Custom");this._addCustomPropertiesToEvent(b,a),this._sendRecord(b)}},d.prototype.setContext=function(a,b,c){this._contextProperties.setProperty(a,b,c)},d.prototype._createEventRecord=function(b,c){var d=new a.datamodels.Record;d.EventType=b.toLowerCase(),d.Type=c,d.Extension.Add("EventInfo.Source","JS_default_source"),d.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,d.Extension.Add("EventInfo.Sequence",this._sequence.toString()),d.Extension.Add("EventInfo.Name",b.toLowerCase());var e=new Date;return d.Timestamp=a.datamodels.utils.GetTimeStampWithValue(e.getTime()),d.Extension.Add("EventInfo.Time",e.toISOString()),d.Extension.Add("EventInfo.SdkVersion","ACT-JS-"+clienttelemetry_build.version),d},d.prototype._addCustomPropertiesToEvent=function(a,b){this._addEventPropertiesToEvent(a,this._contextProperties),this._addEventPropertiesToEvent(a,b)},d.prototype._addEventPropertiesToEvent=function(b,c){c.timestamp&&c.timestamp>=new Date("1/1/2000").getTime()&&(b.Timestamp=a.datamodels.utils.GetTimeStampWithValue(c.timestamp),b.Extension.AddOrReplace("EventInfo.Time",new Date(c.timestamp).toISOString()));var d=c.properties;if(d&&d.length>0)for(var e=0;e<d.length;e++)d[e].key&&"string"==typeof d[e].key&&d[e].value&&"string"==typeof d[e].value&&(this._isPii(d[e].pii)?(b.AddOrReplacePII(d[e].key,d[e].value,d[e].pii),b.Extension.Remove(d[e].key)):(b.Extension.AddOrReplace(d[e].key,d[e].value),b.PIIExtensions.Remove(d[e].key)))},d.prototype._isPii=function(b){if(0==b)return!1;var c=!1;for(var d in a.datamodels.PIIKind)isNaN(d)||d==b&&(c=!0);return c},d.prototype._sendRecord=function(a){b.SendAsync(this._tenantToken,[a])},d}();a.Logger=d;var e=function(){function a(){this.name=null,this.timestamp=null,this.properties=[]}return a.prototype.setProperty=function(b,c,d){if(!b||!a._propertyNameRegex.test(b))throw new g(3);c&&this.properties.push(d?{key:b,value:c,pii:0!=d?d:null}:{key:b,value:c,pii:null})},a._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,a}();a.EventProperties=e;var f=function(){function a(){this.key=null,this.value=null,this.pii=null}return a}();a.Property=f,function(a){a[a.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",a[a.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",a[a.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME"}(a.TelemetryError||(a.TelemetryError={}));var g=(a.TelemetryError,function(){function a(a){this.errorCode=null,this.errorCode=a}return a.prototype.ErrorCode=function(){return this.errorCode},a.prototype.toString=function(){switch(this.errorCode){case 1:return"Invalid tenant token";case 2:return"Eventproperties.name can not be null or empty";case 3:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9]([a-zA-Z0-9]|_|.){2,198}[a-zA-Z0-9]$";default:return"Unknown error"}},a}());a.Exception=g}(a.telemetry||(a.telemetry={})),a.telemetry}(a.applications||(a.applications={})),a.applications}(microsoft||(microsoft={}));var Skype=window.Skype||{};Skype.joinLauncher=function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if("."===(m=a[k]))a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if((e=o[n.slice(0,l).join("/")])&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return void 0!==b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),"require"===(k=m.f))u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("Tracking",["Config/Tracking","Helpers","window","Config"],function(a,b,c,d){"use strict";function e(){for(var a;0!==m.length;)a=m.shift(),n.track(a)}function f(){l=!0;var a="undefined"==typeof TRACKING_SKYPEPN?"static"+c.location.pathname+c.location.search:TRACKING_SKYPEPN,b={autoCapture:{pageView:!0,onLoad:!0,onUnload:!0,scroll:!0,resize:!0,lineage:!0,click:!0},coreData:{appId:"JoinSkypeCom",env:d.env,pageName:a}};awa.init(b),e()}function g(){var b,d,e=a.globalVariables,f=Object.keys(e);for(d=0;d<f.length;d++)b=f[d],c[b]=e[b]}function h(a){var b,c,d,e=Object.keys(a),f=[];for(d=0;d<e.length;d++)b=e[d],c=typeof a[b],"string"!==c&&"number"!==c?"function"===c&&(f.push(b),f.push(a[b]())):(f.push(b),f.push(a[b]));return f.join(",")}var i="",j={},k=a.eventParams,l=!1,m=[],n={};return n.track=function(a){return void 0!==k[a]&&(!1!==l&&(i+","+b.String.replacePlaceholders(k[a],j),!0))},n.init=function(c){i=h(a.commonParams),g(),b.Page.injectScript("https://az725175.vo.msecnd.net/scripts/jsll-4.js",function(){f(),"function"==typeof c&&c()})},n.setPlaceholderValue=function(a,c){j[a]=c,i=b.String.replacePlaceholders(i,j)},n.getPlaceholderValues=function(){return j},n.getCommonTrackingParams=function(){return i},n.getQueue=function(){return m},n.reset=function(){i="",j={},l=!1,m=[]},n}),c("VisitFlow",["Config"],function(a){"use strict";var c={},d=a.visitFlow.steps,e=a.visitFlow.params;return c.start=function(a,c){function f(a){var c,d;!0!==a&&0!==g.length&&(d=g.shift(),c=b(d),c.start(f,h))}var g,h;g=void 0===d[a]?d.default:d[a],h=void 0===e[c]?{}:e[c],f()},c}),c("Observable",["window"],function(a){"use strict";function b(b,c){a.setTimeout(function(){b(c)},0)}function c(a){var c,d=a,e=[];return c=function(a){var c;if(void 0===a)return d;if(a!==d)for(d=a,c=0;c<e.length;c++)b(e[c],d)},c.subscribe=function(a){return"function"==typeof a&&(e.push(a),!0)},c.unsubscribe=function(a){var b,c=!1;if("function"!=typeof a||0===e.length)return!1;for(b=0;b<e.length;b++)e[b]===a&&(e.splice(b,1),c=!0);return c},c}var d={};return d.create=function(a){return new c(a)},d}),c("Events",["window"],function(a){"use strict";var b={},c={},d=-1;return b.subscribe=function(a,b){var e;return c[a]||(c[a]=[]),e=(++d).toString(),c[a].push({token:e,func:b}),e},b.publish=function(b,d){return!!c[b]&&(a.setTimeout(function(){for(var a=c[b],e=a?a.length:0;e--;)a[e].func(d)},0),!0)},b.unsubscribe=function(a){var b,d,e;for(b in c)if(c[b])for(d=0,e=c[b].length;d<e;d++)if(c[b][d].token===a)return c[b].splice(d,1),a;return!1},b.getSubscribedEvents=function(){return c},b}),c("Permissions",["Observable"],function(a){"use strict";var b={};return b.guestUserCreation=a.create(),b}),c("UserInfo",["Observable","Config","Helpers","Telemetry","Tracking","window"],function(a,b,c,d,e,f){"use strict";function g(a,b){var c={remoteUri:b.url,method:b.method,status:b.statusCode,duration:b.duration};d.log("xhr",c)}function h(a){var b=a.firstname||a.lastname,c=a.avatarUrl;k.displayName(b),k.skypeId(a.username),k.avatarUrl(c)}function i(a){void 0!==a&&(k.skypeToken.unsubscribe(i),c.Ajax.get(b.urls.profile).setHeader("Content-Type","application/json").setHeader("Accept","application/json").setHeader("X-Skypetoken",a).onSuccess(h).always(g).send())}function j(a){return a&&a.skypetoken?(k.skypeToken(a.skypetoken),k.signedIn(!0),void e.track("silentLoginSucceeded")):(k.signedIn(!1),a&&"timeout"===a.error?void e.track("silentLoginTimedOut"):void e.track("silentLoginFailed"))}var k={},l=f.SKYPE.login.Silent;return k.signedIn=a.create(),k.skypeToken=a.create(),k.displayName=a.create(),k.skypeId=a.create(),k.avatarUrl=a.create(),k.fetch=function(a,c){!0!==c&&k.skypeToken.subscribe(i),e.track("silentLoginStarted"),l.init(b.silentLogin[a]).setCallback(j).load()},k}),c("document",[],function(){"use strict";return document}),c("WebSkypeLauncher",["GuestUser","Thread","Session","Helpers","Config","document","window"],function(a,b,c,d,e,f,g){"use strict";function h(a){var f={THREAD_ID:g.encodeURIComponent(b.id()),FLOW_ID:c.id(),MODALITY:void 0!==b.modality()?b.modality():e.defaultModality};return d.String.replacePlaceholders(a,f)}function i(a,c){return a=h(a),void 0!==b.offSkypeInviteLongId()&&(a=d.Url.addParam(a,"inviteId",b.offSkypeInviteLongId(),!1,c)),a}function j(b){var c=f.createElement("form"),d=f.createElement("input");if(c.action=i(e.urls.webClient,!1),c.method="POST",d.type="hidden",d.name="skypetoken",d.value=a.skypeToken(),c.appendChild(d),f.body.appendChild(c),"number"==typeof b)return void g.setTimeout(function(){c.submit()},b);c.submit()}function k(a,b){var c=i(e.urls.login,!0),f=i(e.urls.swcChat,!0);!0===b?d.Url.redirect(f,a):d.Url.redirect(c,a)}var l={};return l.launch=function(a,b,c){if(!0===a)return void j(b);k(b,c)},l}),c("VisitFlow/WebClientRedirect",["Permissions","WebSkypeLauncher"],function(a,b){"use strict";var c={};return c.start=function(c){if(!0!==a.guestUserCreation())return b.launch(!1,500,!1),void c(!0);c()},c}),c("VisitFlow/JoinPrompt",["Views","Thread","Helpers","Telemetry","window"],function(a,b,c,d,e){"use strict";function f(){var a={client_time:e.Date.now(),milestone:"launch_native",result:"launch_web_selection",thread_id:b.id()};d.log("pageFlow",a)}var g={};return g.start=function(b,d){var e;if(!1===d.joinPromptDesktop&&"Desktop"===c.Environment.deviceType)return void b();e="Android"!==c.Environment.OS||"Chrome"!==c.Environment.browserName&&"Firefox"!==c.Environment.browserName?"Mobile"===c.Environment.deviceType||"Tablet"===c.Environment.deviceType||!0===d.joinPromptStopsFlow?"joinPromptMobile":"joinPromptDesktop":"joinPromptAndroid",a.display(e,b),f()},g}),c("VisitFlow/NativeClientLaunch",["NativeSkypeLauncher","Thread","Helpers","Views","Telemetry","window"],function(a,b,c,d,e,f){"use strict";function g(a){var c={client_time:f.Date.now(),milestone:"launch_native",thread_id:b.id()};c.result=a?"invoked":"notInvoked",e.log("pageFlow",c)}var h={};return h.start=function(b,e){function f(){a.launch(function(a){if(!0===a)return d.display("nativeClientLaunched"),g(!0),void b(!0);g(!1),b()})}return!1===e.nativeLauncherDesktop&&"Desktop"===c.Environment.deviceType?void b():"Android"!==c.Environment.OS||"Chrome"!==c.Environment.browserName&&"Firefox"!==c.Environment.browserName?void f():void b()},h}),c("Thread",["Observable","Config","Telemetry","Helpers","Events","UserInfo","window"],function(a,b,c,d,e,f,g){"use strict";function h(a){if(void 0!==a){var b=a.split(":");return 1===b.length?"8:"+a:2===b.length&&"live"===b[0]?"1:"+b[1]:a}}function i(a,b){var d={remoteUri:b.url,method:b.method,status:b.statusCode,duration:b.duration};c.log("xhr",d)}function j(a,b){404===b.statusCode?e.publish("threadIdNotFound"):410===b.statusCode?e.publish("urlHasExpired"):e.publish("requiredDataFetchFailed")}function k(a,b){404===b.statusCode||400===b.statusCode||410===b.statusCode?e.publish("offSkypeInviteIdNotFound"):e.publish("requiredDataFetchFailed")}function l(a){e.publish("fingerprintCreateFailed")}function m(a){e.publish("fingerprintCreateSuccess")}function n(a){var b,c,d=null!==a.ChatBlob;y.action(a.Action),y.id(a.Resource),y.longId(a.Id),y.isGroup(d),!0===d?y.blob(a.ChatBlob):(b=a.Resource.indexOf(":"),c=a.Resource.slice(b+1),y.recipient(c))}function o(a){var b=h(a.InviterSkypeId);y.id(b),y.recipient(a.InviterSkypeId),y.clientSource(a.ClientSource),y.offSkypeInviteLongId(a.LongId),f.displayName(a.InviterName)}function p(a,b,c){var e,f;if(void 0!==x[a]&&void 0!==b&&("skypeUri"===a?(f=x[a][y.modality()],u("nativeClientCustomLaunchUris",a,y.modality())):(f=x[a],u("nativeClientCustomLaunchUris",a)),void 0!==f))return c=void 0!==c?g.encodeURIComponent(c):"",e={action:y.action(),customAction:b,fallbackUrl:c,isVideoOn:y.isVideoOn(),skypeId:y.recipient()},d.String.replacePlaceholders(f,e)}function q(a,b,c,e){var f,h;if(void 0!==v[a]&&void 0!==(h=v[a]))return e=void 0!==e?g.encodeURIComponent(e):"",f={skypeId:b,offSkypeInviteId:c,fallbackUrl:e,packageId:t()},u("nativeOffSkypeInvitesUris",a),d.String.replacePlaceholders(h,f)}function r(a,b,c){var e,f,h;if(void 0!==y.isGroup()&&void 0!==w[b]&&(c=void 0!==c?g.encodeURIComponent(c):"",e={skypeId:y.recipient(),threadId:y.id(),blob:y.blob(),sessionId:a,fallbackUrl:c,packageId:t()},f=!0===y.isGroup()?"group":"oneToOne",void 0!==(h=w[b][f][y.action()])))return u("nativeClientLaunchUris",b,f,y.action()),d.String.replacePlaceholders(h,e)}function s(a,b,c,e,f){var g=d.Ajax.post(a).setHeader("Accept","application/json").onSuccess(c).onError(e).always(i);return void 0!==f?g.setTimeout(f).sendJSON(b):g.sendJSON(b),!0}function t(){return void 0!==y.detectedCountry()&&"in"===y.detectedCountry()?"com.skype.m2":"com.skype.raider"}function u(a,b,d,e){var f,h=";";f=a.concat(h,b,h,d,h,e);var i={client_time:g.Date.now(),milestone:"log_uri_type",thread_id:y.id()};i.result=f,c.log("pageFlow",i)}var v,w,x,y={};return y.id=a.create(),y.action=a.create(),y.isVideoOn=a.create(),y.isGroup=a.create(),y.longId=a.create(),y.shortId=a.create(),y.blob=a.create(),y.recipient=a.create(),y.offSkypeInviteShortId=a.create(),y.offSkypeInviteLongId=a.create(),y.clientSource=a.create(),y.modality=a.create(),y.customAction=a.create(),y.detectedCountry=a.create(),y.detectedParameter=a.create(),v={intentProtocol:"intent://{skypeId}?chat&utm_source=buddy&utm_content={offSkypeInviteId}#Intent;scheme=skype;package={packageId};S.browser_fallback_url={fallbackUrl};end;",intentUri:"intent:{skypeId}?chat&utm_source=buddy&utm_content={offSkypeInviteId}#Intent;scheme=skype;action=android.intent.action.VIEW;package={packageId};end",skypeUri:"skype:{skypeId}?chat&utm_source=buddy&utm_content={offSkypeInviteId}"},x={intentProtocol:"intent://{customAction}#Intent;scheme=https;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;",intentUri:"intent:{customAction}#Intent;scheme=https;action=android.intent.action.VIEW;package=com.skype.raider;end",skypeUri:{Chat:"skype:{skypeId}?{action}",Audio:"skype:{skypeId}?{action}",Video:"skype:{skypeId}?{action}&video={isVideoOn}"}},w={intentProtocol:{oneToOne:{Call:"intent://{skypeId}?call&session_id={sessionId}#Intent;scheme=skype;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;",Chat:"intent://{skypeId}?chat&session_id={sessionId}#Intent;scheme=skype;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;",Golive:"intent://{skypeId}?golive&session_id={sessionId}#Intent;scheme=skype;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;"},group:{Call:"intent://call?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;",Chat:"intent://?chat&blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;package=com.skype.raider;S.browser_fallback_url={fallbackUrl};end;",Golive:"intent://golive?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;package={packageId};S.browser_fallback_url={fallbackUrl};end;",GoLive:"intent://golive?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;package={packageId};S.browser_fallback_url={fallbackUrl};end;"}},intentUri:{oneToOne:{Call:"intent:{skypeId}?call&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package=com.skype.raider;end",Chat:"intent:{skypeId}?chat&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package=com.skype.raider;end",Golive:"intent:{skypeId}?golive&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package=com.skype.raider;end"},group:{Call:"intent:call?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package=com.skype.raider;end",Chat:"intent:?chat&blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package=com.skype.raider;end",Golive:"intent:golive?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package={packageId};end",GoLive:"intent:golive?blob={blob}&threadId={threadId}&session_id={sessionId}#Intent;scheme=skype;action=android.intent.action.VIEW;package={packageId};end"}},skypeUri:{oneToOne:{Call:"skype:{skypeId}?call&session_id={sessionId}",Chat:"skype:{skypeId}?chat&session_id={sessionId}",Golive:"skype:{skypeId}?golive&session_id={sessionId}"},group:{Call:"skype:call?blob={blob}&threadId={threadId}&session_id={sessionId}",Chat:"skype:?chat&blob={blob}&threadId={threadId}&session_id={sessionId}",Golive:"skype:golive?blob={blob}&threadId={threadId}&session_id={sessionId}",GoLive:"skype:golive?blob={blob}&threadId={threadId}&session_id={sessionId}"}}},y.sendFingerprint=function(){var a={PlatformVersion:d.Environment.pureOSVersion,Platform:d.Environment.platform,Language:d.Environment.language,ScreenResolution:d.Environment.screenResolution};return d.Ajax.post(b.urls.fingerprintCreate).setHeader("Accept","application/json").setHeader("Version","1.0").onSuccess(m).onError(l).always(i).sendJSON(a),!0},y.fetch=function(a){var c={longId:y.longId(),shortId:y.shortId(),type:a};return s(b.urls.threadInfo,c,n,j)},y.fetchOffSkypeInviteInfo=function(a){var c={longId:y.offSkypeInviteLongId(),shortId:y.offSkypeInviteShortId(),type:a};return s(b.urls.inviteInfo,c,o,k,b.timeout.offlineInvites)},y.getOffSkypeInviteId=function(){return void 0!==y.offSkypeInviteShortId()?y.offSkypeInviteShortId():y.offSkypeInviteLongId()},y.getSkypeUri=function(a){return r(a,"skypeUri")},y.getIntentUri=function(a){return r(a,"intentUri")},y.getIntentProtocol=function(a,b){return r(a,"intentProtocol",b)},y.getCustomActionSkypeUri=function(a){return p("skypeUri",a)},y.getCustomActionIntentUri=function(a){return p("intentUri",a)},y.getCustomActionIntentProtocol=function(a,b){return p("intentProtocol",a,b)},y.getOffSkypeInviteSkypeUri=function(a,b){return q("skypeUri",a,b)},y.getOffSkypeInviteIntentUri=function(a,b){return q("intentUri",a,b)},y.getOffSkypeInviteIntentProtocol=function(a,b,c){return q("intentProtocol",a,b,c)},y}),c("Helpers/Ui",["window","document"],function(a,b){"use strict";var c={};return c.hasClass=function(a,b){var c=new RegExp("(?:^|\\s)"+b+"(?!\\S)","g");return!!a.className.match(c)},c.addClass=function(a,b){return!0!==c.hasClass(a,b)&&(a.className+=" "+b,!0)},c.removeClass=function(a,b){var d;return!1!==c.hasClass(a,b)&&(d=new RegExp("(?:^|\\s)"+b+"(?!\\S)","g"),a.className=a.className.replace(d,""),!0)},c.bind=function(){function a(a,b,c,d){d=!!d,a.addEventListener(b,c,d)}function c(a,b,c){a.attachEvent(b,c)}return b.addEventListener?a:c}(),c.unbind=function(){function a(a,b,c){a.removeEventListener(b,c,!1)}function c(a,b,c){a.detachEvent(b,c)}return b.removeEventListener?a:c}(),c}),c("Helpers/String",["document"],function(a){"use strict";var b={};return b.replacePlaceholders=function(a,b){var c,d,e,f,g;if("string"!=typeof a)return"";if("object"!=typeof b||null===b)return a;for(c=Object.keys(b),g=0;g<c.length;g++)d=c[g],e=b[d],f=new RegExp("{"+d+"}","g"),a=a.replace(f,e);return a},b.escapeHtmlEntities=function(a){return"string"!=typeof a?"":a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},b}),c("Helpers/Page",["document"],function(a){"use strict";var b,c={};return b=function(){function b(a,b,c){a.addEventListener(b,c,!1)}function c(a,b,c){a.attachEvent(b,c)}return a.addEventListener?b:c}(),c.injectScript=function(c,d,e,f){var g=f||a.getElementsByTagName("body").item(0),h=a.createElement("script");h.async=!0,h.setAttribute("type","text/javascript"),h.setAttribute("src",c),b(h,"load",d),"function"==typeof e&&b(h,"error",e),g.appendChild(h)},c.init=function(b){var c,d=a.body.getAttribute("data-params");if(null===d)return void b.run();c=d.split(";;"),b.run.apply(null,c)},c}),c("Helpers/Url",["window"],function(a){"use strict";var b={};return b.redirect=function(b,c){if("number"!=typeof c)return void(a.location.href=b);a.setTimeout(function(){a.location.href=b},c)},b.addParam=function(b,c,d,e,f){var g=f?a.encodeURIComponent("?"):"?",h=f?a.encodeURIComponent("&"):"&";d=d||"",e&&(d=a.encodeURIComponent(d));var i=null===c||""===c||void 0===c?d:c+"="+d;return f&&(i=a.encodeURIComponent(i)),"string"!=typeof b?"":-1===b.indexOf("?")?b.concat(g,i):-1!==b.indexOf("=")?b.concat(h,i):0===b.substr(1).length?b.concat(i):b.concat(h,i)},b.getQueryParams=function(a){var c,d={},e=b.getQueryPart(a);return""===e?{}:(c=e.substr(1).split("&"),c.map(function(a){var b,c,e=a.indexOf("=");if(-1===e)return void(d[a]=void 0);b=a.substr(0,e),c=a.substr(e+1),d[b]=c}),d)},b.getQueryPart=function(b){var c;return void 0===b?a.location.search:"string"!=typeof b?"":(c=b.indexOf("?"),b.substr(c))},b.getQueryParamValue=function(a,c){var d=b.getQueryParams(c);return void 0===d[a]?"":d[a]},b.isQueryParamSet=function(a,c,d){var e,f=b.getQueryParams(d),g=Object.keys(f);for(!0===c&&(a=a.toLowerCase()),e=0;e<g.length;e++)if((!0===c?g[e].toLowerCase():g[e])===a)return!0;return!1},b.getUrlWithoutProtocol=function(b){if(void 0===b){var c=a.location;return c.host+c.pathname+c.search}return"string"!=typeof b?"":-1!==b.indexOf("https")?b.replace("https://",""):b.replace("http://","")},b}),c("Helpers/Environment",["window"],function(a){"use strict";function b(a){var b=a.match(new RegExp("Windows NT ([\\d.]+)")),c={5.1:"XP",5.2:"Server 2003","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"};return b?c[b[1]]:"Unknown"}function c(a){var b=a.match(new RegExp("Windows Phone(?: OS)* ([\\d.]+)"));return b?b[1]:"Unknown"}function d(a){var b=a.match(new RegExp("Mac OS X ([\\d_.]+)"));return b?b[1].replace(/_/g,"."):"Unknown"}function e(a){var b=a.match(new RegExp("Android ([\\d.]+)"));return b?b[1]:"Unknown"}function f(a,b){var c,d=a.match(new RegExp("(iPhone OS|CPU OS) ([\\d_]+)"));return d?(c=d[2].replace(/_/g,"."),void 0===b||!0===b?("iPhone OS"===d[1]?"iPhone":"iPad")+" "+c:c):"Unknown"}function g(a){var b,c=a.match(new RegExp("MSIE ([\\d.]+)"));return c?c[1]:(b=a.match(new RegExp("rv:([\\d.]+)")),b?b[1]:"")}function h(a,b){var c;return"Safari"===b&&(b="Version"),"Opera"===b&&(b="(?:Version|OPR)"),c=a.match(new RegExp(b+"/([\\d.]+)")),c?c[1]:""}var i=a.navigator.userAgent,j={};return j.getOS=function(a){var b,c,d={"Windows Phone":/windows\sphone/i,"Windows RT":/ arm;/i,Windows:/(windows|win32)/i,iOS:/(iPad|iPhone|iPod)/i,"Mac OS X":/(macintosh|mac os x)/i,Android:/android/i,ChromeOS:/ CrOS /i,Linux:/(linux|x11)/i},e=Object.keys(d);for(c=0;c<e.length;c++)if(b=e[c],a.match(d[b]))return b;return"Unknown"},j.OS=function(){return j.getOS(i)}(),j.getOSVersion=function(a,g){var h=j.getOS(a);return"Windows"===h||"Windows RT"===h?b(a):"Windows Phone"===h?c(a):"Mac OS X"===h?d(a):"Android"===h?e(a):"iOS"===h?f(a,g):"Unknown"},j.OSVersion=function(){return j.getOSVersion(i,!0)}(),j.pureOSVersion=function(){return j.getOSVersion(i,!1)}(),j.getDeviceType=function(a){var b=/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i,c=/tablet|ipad/i,d=/^(?=.*\bTrident\b)(?=.*\bTablet PC\b).*$/i;return a.match(c)&&!a.match(d)?"Tablet":a.match(b)?"Mobile":"Desktop"},j.deviceType=function(){return j.getDeviceType(i)}(),j.getBrowserName=function(a){var b,c,d={Opera:"(OPR/|Opera)",Edge:"Edge",MSIE:"Trident",Chrome:"Chrome",Firefox:"Firefox",Safari:"Safari"},e=Object.keys(d);for(c=0;c<e.length;c++)if(b=e[c],a.match(new RegExp(d[b])))return b;return"Unknown"},j.browserName=function(){return j.getBrowserName(i)}(),j.getBrowserVersion=function(a){var b=j.getBrowserName(a);return"MSIE"===b?g(a):h(a,b)},j.browserVersion=function(){return j.getBrowserVersion(i)}(),j.getScreenResolution=function(a){return null==a.width||void 0===a.width||null==a.height||void 0===a.height?"Unknown":a.width+"x"+a.height},j.screenResolution=function(){return j.getScreenResolution(a.screen)}(),j.getPlatform=function(a){return a.platform},j.platform=function(){return j.getPlatform(a.navigator)}(),j.getLanguage=function(a){var b=a.language||a.userLanguage;return void 0!==b&&b.length>2?b.substr(0,2):b},j.language=function(){return j.getLanguage(a.navigator)}(),j}),c("Helpers/Country",["Helpers/Url"],function(a){"use strict";var b={};return b.getCountry=function(b){var c="in",d=a.getQueryParamValue("country");return void 0!==d&&d===c?c:b},b}),c("Helpers/Parameter",["Helpers/Url"],function(a){"use strict";var b={};return b.getParameter=function(){var b=a.getQueryParamValue("experience");return void 0!==b&&"new"===b},b}),c("Helpers/Ajax",["window"],function(a){"use strict";var b,c={};return b=function(b,c){function d(b,c){var e,f,g,h,i,j=[],k=Object.keys(b);for(i=0;i<k.length;i++)f=k[i],h=c?c+"["+f+"]":f,g=b[f],e="object"==typeof g?d(g,h):h+"="+a.encodeURIComponent(g),j.push(e);return j.join("&")}function e(){return{statusCode:l.status,statusText:l.statusText,url:b,method:c,duration:j-i}}function f(){var b=l.getResponseHeader("content-type")&&0===l.getResponseHeader("content-type").indexOf("application/json");if(!1===b&&null===l.response)return"";if(!0===b&&null===l.response)return{};if(!0===b)try{return a.JSON.parse(l.response)}catch(a){throw new Error("Ajax call: response expected to be valid JSON")}return l.response}function g(){var b,c;if(4===l.readyState){if(j=a.Date.now(),b=e(),c=f(),l.status>=200&&l.status<300)return m(c,b),void o(c,b);n(c,b),o(c,b)}}function h(b){i=a.Date.now(),l.send(b)}var i,j,k=this,l=new a.XMLHttpRequest,m=function(){},n=function(){},o=function(){};l.open(c,b),l.onreadystatechange=g,k.setHeader=function(a,b){return l.setRequestHeader(a,b),k},k.setTimeout=function(a){return l.timeout=a,k},k.onSuccess=function(a){return m=a,k},k.onError=function(a){return n=a,k},k.onTimeout=function(a){return l.ontimeout=a,k},k.always=function(a){return o=a,k},k.send=function(a){h(a)},k.sendJSON=function(b){if("object"==typeof b&&null!==b&&(b=a.JSON.stringify(b)),"string"!=typeof b)throw new Error("Ajax call: data provided is not JSON");l.setRequestHeader("Content-Type","application/json"),h(b)},k.sendForm=function(a){"object"==typeof a&&(a=d(a)),l.setRequestHeader("Content-Type","x-www-form-urlencoded"),h(a)}},c.get=function(a){return new b(a,"GET")},c.post=function(a){return new b(a,"POST")},c.put=function(a){return new b(a,"PUT")},c.del=function(a){return new b(a,"DELETE")},c}),c("Helpers/Cookie",["window","document"],function(a,b){"use strict";function c(a,b){var c,d,e="string"==typeof b&&""!==b?b:g,f=Object.keys(a),h=[];if(a.hasOwnProperty("singleValue"))return a.singleValue;for(c=0;c<f.length;c++)d=f[c],h.push(d+"="+a[d]);return h.join(e)}function d(a,b){var c,d,e="string"==typeof b&&""!==b?b:g,f={},h=[],i=[];for(h=a.split(e),c=0;c<h.length;c++)d=h[c],i=-1!==d.indexOf("=")?h[c].split("="):["singleValue",d],f[i[0].trim()]=i[1].trim();return f}function e(a){var b,c=Date.now();if("number"==typeof a)return b=1e3*parseInt(a,10)+c,new Date(b)}var f={},g=":";return f.getCookie=function(a){var b;return b=f.parse(),!0===f.hasCookie(a)?b[a]:{}},f.setCookie=function(a,d,g,h,i,j){var k=[],l="",m=Math.round(Date.now()/1e3),n="object"==typeof d?d:{};!1===f.hasCookie(a)&&(n.TS=m),n.TM=m,n=c(n),"string"==typeof g&&""!==g&&k.push("domain="+g),"string"==typeof h&&""!==h&&k.push("path="+h),"string"==typeof i&&k.push("expires="+i),"number"==typeof i&&(i=e(i),k.push("expires="+i.toGMTString())),"object"==typeof i&&k.push("expires="+i.toGMTString()),void 0!==typeof j&&!0===j&&k.push("secure=true"),l=k.length>0?";"+k.join(";"):"",b.cookie=a+"="+n+l},f.hasCookie=function(a){return f.parse().hasOwnProperty(a)},f.getCookieValue=function(a,b){var c=f.getCookie(a);return c="object"==typeof c?c:{},void 0!==c[b]?c[b]:void 0},f.setCookieValue=function(a,b,c,d,e,g,h){var i=f.getCookie(a);i="object"==typeof i?i:{},void 0!==b&&""!==b||(b="singleValue"),i[b]=c,f.setCookie(a,i,d,e,g,h)},f.removeCookie=function(a,b,c,d,g){var h=d||e(-1);!1!==f.hasCookie(a)&&f.setCookie(a,"",b,c,h,g)},f.parse=function(){var a,c,e,f,g,h={},i=[];if(""===b.cookie)return h;for(i=b.cookie.split(";"),a=0;a<i.length;a++)c=i[a],e=c.indexOf("="),f=c.substring(0,e).trim(),g=c.substring(e+1).trim(),h[f]=d(g);return h},f}),c("Helpers/Obj",["document"],function(a){"use strict";var b={};return b.clone=function(){function a(a,b){var c,d,e=Object.keys(b);for(d=0;d<e.length;d++)c=e[d],a[c]=b[c]}for(var b={},c=0;c<arguments.length;c++)void 0!==arguments[c]&&null!==arguments[c]&&a(b,arguments[c]);return b},b}),c("window",[],function(){"use strict";return window}),c("NativeSkypeLauncher",["Thread","Session","Helpers","document","window"],function(a,b,c,d,e){"use strict";function f(a,b){if("function"==typeof a)return void 0!==b?void a(b):void a()}function g(){return void 0!==e.navigator.msLaunchUri&&("Windows"===c.Environment.OS&&"Edge"!==c.Environment.browserName)}function h(){return!0===g()?j.msLaunchUri:"Android"===c.Environment.OS&&"Firefox"===c.Environment.browserName?j.iframeNoDetection:"ChromeOS"===c.Environment.OS?j.noLaunch:"Safari"===c.Environment.browserName||"Android"===c.Environment.OS?j.url:j.iframe}var i={},j={};return j.msLaunchUri=function(a,b){var c=e.setTimeout(function(){f(b,!1)},2e3);e.navigator.msLaunchUri(a,function(){e.clearTimeout(c),f(b,!0)},function(){e.clearTimeout(c),f(b,!1)})},j.iframe=function(a,b){var g,h=d.getElementById("nativeSkypeLauncherFrame"),i=!1;g=function(){i=!0},c.Ui.bind(e,"blur",g),h.src=a,e.setTimeout(function(){if(c.Ui.unbind(e,"blur",g),!1===i)return void f(b,!1);f(b)},2e3)},j.iframeNoDetection=function(a,b){var c=d.getElementById("nativeSkypeLauncherFrame");try{c.contentWindow.location.href=a}catch(a){}e.setTimeout(function(){f(b)},2e3)},j.url=function(a,b){f(b),e.location.href=a},j.noLaunch=function(a,b){f(b)},i.launch=function(d,e){var f,g=h();f="Android"===c.Environment.OS?"Firefox"===c.Environment.browserName||"Chrome"===c.Environment.browserName?a.getIntentProtocol(b.id(),e):a.getIntentUri(b.id()):a.getSkypeUri(b.id()),g(f,d)},i.launchCustomAction=function(b,d,e){var f,g=h();f="Android"===c.Environment.OS?"Firefox"===c.Environment.browserName||"Chrome"===c.Environment.browserName?a.getCustomActionIntentProtocol(d,e):a.getCustomActionIntentUri(d):a.getCustomActionSkypeUri(d),g(f,b)},i.launchOffSkypeInvitesAction=function(b,d){var e,f=h();e="Android"===c.Environment.OS?"Firefox"===c.Environment.browserName||"Chrome"===c.Environment.browserName?a.getOffSkypeInviteIntentProtocol(a.recipient(),a.getOffSkypeInviteId(),d):a.getOffSkypeInviteIntentUri(a.recipient(),a.getOffSkypeInviteId()):a.getOffSkypeInviteSkypeUri(a.recipient(),a.getOffSkypeInviteId()),f(e,b)},i}),c("Config/Tracking",["Helpers","Config"],function(a,b){"use strict";var c={};return c.globalVariables={varSegmentation:0,varClickTracking:0,varCustomerTracking:1,varAutoFirePV:0,Route:"46124",Ctrl:""},c.commonParams={"ms.prod":"Skype","ms.env":b.env,"ms.lang":"{LANGUAGE}","ms.rwd":a.Environment.deviceType.toLowerCase(),"ms.skype_userhash":"{USER_HASHED_ID}","ms.pagetype":"launcher"},c.eventParams={pageViewed:"wcs.cot,0,ms.interactiontype,1,ms.skypepn,{PAGE_PATH},ms.pagetype={PAGE_TYPE}",silentLoginStarted:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,start,ms.ea_action,silent_login",silentLoginSucceeded:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,success,ms.ea_action,silent_login",silentLoginTimedOut:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,time out,ms.ea_action,silent_login",silentLoginFailed:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,no token,ms.ea_action,silent_login",launchNativeAppClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Join Space,ms.ea_action,view",downloadSkypeClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Get Space,ms.ea_action,view",joinUsingWebClientClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Launch Skype for Web,ms.ea_action,view",loggedOut:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Sign in with another account link,ms.ea_action,view",joinAsGuestClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Join as quest link,ms.ea_action,view",webClientLaunched:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Join in Web Client as logged-in user,ms.ea_action,view",webClientLaunchedClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Join in Web Client as anonymous user,ms.ea_action,view",signInClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Sign in with my account,ms.ea_action,view",signUpClicked:"wcs.cot,5,ms.interactiontype,1,ms.skypepn,spaces/launcher,ms.ea_offer,Create an account,ms.ea_action,view"},c}),c("Config/Telemetry",["Session","Config","Helpers","window"],function(a,b,c,d){"use strict";var e={};return e.commonEventProperties={uiVersion:b.clientVersion,session_id:a.id(),user_agent:d.navigator.userAgent},e.events={xhr:{eventName:"swg_spaces_page_xhr"},pageView:{eventName:"swg_spaces_page_view"},pageFlow:{eventName:"weblauncher_join"},captcha:{eventName:"swg_spaces_captcha"},skypeInviteCookieDetection:{eventName:"skype_invite_cookie"}},e}),c("PageHelpers/Footer",["Language","Helpers","document","window"],function(a,b,c,d){"use strict";function e(a){var c=(new d.Date).getFullYear(),e={YEAR:c};a.innerHTML=b.String.replacePlaceholders(a.innerHTML,e)}function f(){var a=o[m.selectedIndex].text;n.innerHTML=a}function g(){var b=o[m.selectedIndex].value;f(),a.set(b),d.location.reload(!0)}function h(){b.Ui.addClass(n,"language-selector__selected--focused")}function i(){b.Ui.removeClass(n,"language-selector__selected--focused")}function j(){var a=c.getElementById("copyright");e(a),b.Ui.removeClass(a,"hide")}function k(){var d;if(l=a.get(),m=c.getElementById("languageSelector"),n=c.getElementById("selectedLanguage"),void 0!==(o=m.querySelectorAll("option"))){for(d=0;d<o.length;d++)if(o[d].value===l){m.selectedIndex=d;break}f(),b.Ui.bind(m,"change",g),b.Ui.bind(m,"focus",h),b.Ui.bind(m,"blur",i),b.Ui.bind(m,"mouseover",h),b.Ui.bind(m,"mouseout",i)}}var l,m,n,o,p={};return p.init=function(a){j(),!0!==a&&k()},p}),c("PageHelpers/Telemetry",["Helpers","Config","Telemetry","document","window"],function(a,b,c,d,e){"use strict";function f(a){j.host=e.location.hostname,void 0!==a&&(j.threadId=a)}function g(a){j[a]=e.Date.now()-e.performance.timing.navigationStart}function h(){var c=a.Url.getQueryParamValue("source");void 0!==c&&-1!==b.validReferrers.indexOf(c)&&(j.source=c)}var i={},j={durationReady:"",durationLoaded:"",source:""};return i.init=function(b){return void 0!==e.performance&&void 0!==e.performance.timing&&void 0!==e.performance.timing.navigationStart&&(h(),a.Ui.bind(d,"DOMContentLoaded",function(){g("durationLoaded")}),a.Ui.bind(e,"load",function(){g("durationReady"),f(b),c.log("pageView",j)}),!0)},i}),c("Pages/OffSkypeInvitesLauncher",["VisitFlow","PageHelpers/Footer","Session","Language","Telemetry","PageHelpers/Telemetry","Tracking","Config","Helpers","Thread","Events","window"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(){return l.location.pathname.replace(/\/+$/,"").split("/").pop()}function n(){i.Url.redirect(h.urls.error,500)}function o(){i.Url.redirect(h.urls.inviteNotFound,500)}function p(){var a={client_time:l.Date.now(),milestone:"start",source:j.clientSource()};e.log("pageFlow",a)}function q(a){if(-1!==l.location.pathname.indexOf("/invite"))return void j.offSkypeInviteShortId(a);j.offSkypeInviteLongId(a)}var r={};return r.run=function(h){var l=m();b.init(),k.subscribe("requiredDataFetchFailed",n),k.subscribe("offSkypeInviteIdNotFound",o),k.subscribe("urlHasExpired",o),void 0===c.id()&&c.generate(),j.detectedCountry(i.Country.getCountry(h)),e.setCommonProperty("path","invite"),g.init(),g.setPlaceholderValue("LANGUAGE",d.get()),g.setPlaceholderValue("USER_HASHED_ID",""),q(l),j.fetchOffSkypeInviteInfo("oi"),f.init(j.id()),p(),a.start("offSkypeInvites")},i.Page.init(r),r}),c("Views/JoinPromptOffSkypeInviteAndroid",["NativeSkypeLauncher","Helpers","Thread","Config","UserInfo","document","window"],function(a,b,c,d,e,f,g){"use strict";function h(){var a=d.urls.downloadAndoridSkypeLite,b=d.urls.download;return void 0!==c.detectedCountry()&&"in"===c.detectedCountry()?a+"?referrer="+g.encodeURIComponent("utm_source=buddy&utm_content="+c.getOffSkypeInviteId()):b+"?referrer="+g.encodeURIComponent("utm_source=buddy&utm_content="+c.getOffSkypeInviteId())}function i(){var a=h();b.Url.redirect(a,500)}function j(){var a=f.getElementById("androidGenericMessageJoin"),c=f.getElementById("androidGenericMessageDownload"),d=f.getElementById("androidDownloadMessage"),e=f.getElementById("launchAndroidClient");b.Ui.addClass(a,"hide"),b.Ui.addClass(c,"hide"),b.Ui.removeClass(d,"hide"),b.Ui.addClass(e,"hide")}function k(){g.location.hash.substr(1)===o&&j()}function l(){var a,c=f.getElementById("androidGenericMessageJoin"),d=b.String.escapeHtmlEntities(e.displayName()),g={user_name:d};a=b.String.replacePlaceholders(c.innerHTML,g),a=a.replace(d,"<b>"+d+"</b>"),c.innerHTML=a}var m,n,o="skypeNotInstalled",p={};return p.display=function(c){var d=f.getElementById("viewJoinPromptAndroid");m=f.getElementById("downloadAndroidClient"),n=f.getElementById("launchAndroidClient"),k(),b.Ui.bind(g,"hashchange",k),b.Ui.bind(m,"click",function(a){a.preventDefault(),i()}),l(),b.Ui.bind(n,"click",function(){a.launchOffSkypeInvitesAction(void 0,g.location.href+"#"+o),c(!0)}),b.Ui.removeClass(d,"hide")},p}),c("Views/JoinPromptOffSkypeInviteDesktop",["NativeSkypeLauncher","Helpers","Thread","Config","UserInfo","document","window"],function(a,b,c,d,e,f,g){"use strict";function h(){var a,c=f.getElementById("desktopGenericMessageJoin"),d=b.String.escapeHtmlEntities(e.displayName()),g={user_name:d};a=b.String.replacePlaceholders(c.innerHTML,g),a=a.replace(d,"<b>"+d+"</b>"),c.innerHTML=a}function i(){var a=f.getElementById("desktopGenericMessageDownload");b.Ui.addClass(a,"hide")}var j={};return j.display=function(a){var c=f.getElementById("viewJoinPromptDesktop"),d=f.getElementById("launchClient");h(),i(),b.Ui.bind(d,"click",function(){a()}),b.Ui.removeClass(c,"hide")},j}),c("Views/JoinPromptOffSkypeInviteMobile",["NativeSkypeLauncher","Helpers","Thread","Config","UserInfo","document","window"],function(a,b,c,d,e,f,g){"use strict";function h(){var a=d.urls.download,e=void 0!==c.offSkypeInviteShortId()?"shortId":"longId";return"iOS"===b.Environment.OS&&(b.Cookie.setCookieValue(d.cookies.offSkypeInvite.name,d.cookies.offSkypeInvite.key,c.getOffSkypeInviteId(),d.cookies.offSkypeInvite.domain,d.cookies.offSkypeInvite.path,d.cookies.offSkypeInvite.maxAge),b.Cookie.setCookieValue(d.cookies.offSkypeInviteType.name,d.cookies.offSkypeInviteType.key,e,d.cookies.offSkypeInviteType.domain,d.cookies.offSkypeInviteType.path,d.cookies.offSkypeInviteType.maxAge)),"Android"!==b.Environment.OS?a:a+"?referrer="+g.encodeURIComponent("utm_source=buddy&utm_content="+c.getOffSkypeInviteId())}function i(){var a,c=f.getElementById("mobileGenericMessageJoin"),d=b.String.escapeHtmlEntities(e.displayName()),g={user_name:d};a=b.String.replacePlaceholders(c.innerHTML,g),a=a.replace(d,"<b>"+d+"</b>"),c.innerHTML=a}var j={};return j.display=function(c){var d=f.getElementById("viewJoinPromptMobile"),e=f.getElementById("downloadMobileClient"),g=f.getElementById("launchMobileClient"),j=f.getElementById("cookiePolicy");b.Ui.bind(e,"click",function(a){var c=h();a.preventDefault(),b.Url.redirect(c,500)}),b.Ui.bind(g,"click",function(){a.launchOffSkypeInvitesAction()}),i(),b.Ui.removeClass(d,"hide"),j&&"iOS"===b.Environment.OS&&(b.Ui.bind(j,"click",function(){b.Ui.addClass(j,"closed")}),b.Ui.removeClass(j,"closed")),c(!0)},j}),c("VisitFlow/JoinPromptOffSkypeInvitesAction",["Views","Helpers","Telemetry","UserInfo","window"],function(a,b,c,d,e){"use strict";function f(){var a={client_time:e.Date.now(),milestone:"launch_offskype_native",result:"launch_web_selection",thread_id:""};c.log("pageFlow",a)}var g={};return g.start=function(c){function g(){e.clearTimeout(h),i="Android"!==b.Environment.OS||"Chrome"!==b.Environment.browserName&&"Firefox"!==b.Environment.browserName?"Mobile"===b.Environment.deviceType||"Tablet"===b.Environment.deviceType?"joinPromptOffSkypeInviteMobile":"joinPromptOffSkypeInviteDesktop":"joinPromptOffSkypeInviteAndroid",a.display(i,c),f()}var h,i;void 0===d.displayName()?d.displayName.subscribe(g):g()},g}),c("VisitFlow/NativeClientOffSkypeInviteLaunch",["NativeSkypeLauncher","Telemetry","Helpers","Thread","window"],function(a,b,c,d,e){"use strict";function f(a){var c={client_time:e.Date.now(),milestone:"launch_native",thread_id:d.id()};c.result=a?"invoked":"notInvoked",b.log("pageFlow",c)}var g={};return g.start=function(b){function g(){return e.clearTimeout(h),i?void b():"Android"!==c.Environment.OS||"Chrome"!==c.Environment.browserName&&"Firefox"!==c.Environment.browserName?void a.launchOffSkypeInvitesAction(function(a){if(!0===a)return f(!0),void b(!0);f(!1),b()}):void b()}var h,i="iOS"===c.Environment.OS;i&&d.sendFingerprint(),void 0===d.recipient()?d.recipient.subscribe(g):g()},g}),c("Views/NativeClientLaunched",["Helpers","document"],function(a,b){"use strict";var c,d={};return d.display=function(d){c=b.getElementById("viewNativeClientLaunched"),a.Ui.removeClass(c,"hide")},d}),c("GuestUser",["Observable","Config","Helpers","Telemetry","Thread","Session"],function(a,b,c,d,e,f){"use strict";function g(a,c){var e={remoteUri:b.urls.guestUserInfo,method:c.method,status:c.statusCode,duration:c.duration};d.log("xhr",e)}function h(a,b){var c={},d=b.statusCode;switch(0===d&&void 0!==a.Code&&(d=a.Code),d){case 201:c.skypeToken=a.skypetoken,i.skypeToken(a.skypetoken);break;case 405:c.error="joinDisabled";break;case 403:c.error="invalidCaptcha";break;case 412:c.error="tooManyUsers";break;case 500:c.error="serverError";break;default:c.error="busy"}return c}var i={};return i.skypeToken=a.create(),i.isThrottled=a.create(),i.create=function(a,d,i){if("function"!=typeof d)return!1;var j={name:a,threadId:e.id(),shortId:e.shortId(),longId:e.longId(),flowId:f.id()};return i&&(j.captcha=i),c.Ajax.post(b.urls.guestUserInfo).setHeader("Accept","application/json").setHeader("X-Skype-Request-Id",c.Cookie.getCookie(b.cookies.session.name).singleValue).setHeader("csrf_token",c.Cookie.getCookie(b.cookies.csrf.name).singleValue).always(function(a,b){var c=h(a,b);g(a,b),d(c.skypeToken,c.error)}).sendJSON(j),!0},i}),c("Telemetry",["Config","Config/Telemetry","Helpers"],function(a,b,c){"use strict";function d(a,d){return c.Obj.clone(d,h,b.commonEventProperties)}function e(a,c){var e={};return e.eventProperties=d(a,c),e.eventName=b.events[a].eventName,e}function f(b){void 0!==b&&c.Ajax.post(a.urls.telemetry).setHeader("Accept","application/json").setHeader("X-Skype-Request-Id",c.Cookie.getCookie(a.cookies.session.name).singleValue).sendJSON(b)}var g={},h={};return g.setCommonProperty=function(a,b){return"string"==typeof a&&""!==a&&"string"==typeof b&&(h[a]=b,!0)},g.log=function(a,c){-1!==Object.keys(b.events).indexOf(a)&&f(e(a,c))},g}),c("Views",["Helpers","document"],function(a,c){"use strict";var d={},e={nativeClientLaunched:"Views/NativeClientLaunched",joinPromptDesktop:"Views/JoinPromptDesktop",joinPromptMobile:"Views/JoinPromptMobile",joinPromptAndroid:"Views/JoinPromptAndroid",joinPromptOffSkypeInviteDesktop:"Views/JoinPromptOffSkypeInviteDesktop",joinPromptOffSkypeInviteMobile:"Views/JoinPromptOffSkypeInviteMobile",joinPromptOffSkypeInviteAndroid:"Views/JoinPromptOffSkypeInviteAndroid",joinPromptCustomAndroid:"Views/JoinPromptCustomAndroid",joinPromptCustomMobile:"Views/JoinPromptCustomMobile",webClientSignIn:"Views/WebClientSignIn",webClientGuestSignIn:"Views/WebClientGuestSignIn",botAddPrompt:"Views/BotAddPrompt",botAddSuccess:"Views/BotAddSuccess",companyAddPrompt:"Views/CompanyAddPrompt",companyAddSuccess:"Views/CompanyAddSuccess"};return d.display=function(d,f){var g,h,i=c.getElementsByClassName("view");if(void 0===e[d])return!1;for(g=b(e[d]),h=0;h<i.length;h++)a.Ui.addClass(i[h],"hide");return g.display(f),!0},d}),c("Helpers",[],function(){"use strict";var a,c,d=["Ajax","Cookie","Country","Environment","Obj","Page","Parameter","String","Ui","Url"],e={};for(c=0;c<d.length;c++){a=d[c];try{e[a]=b("Helpers/"+a)}catch(a){}}return e}),c("Session",["Config","Helpers"],function(a,b){"use strict";function c(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var d={};return d.id=function(){return b.Cookie.getCookie(a.cookies.session.name).singleValue},d.generate=function(){var d=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c();return b.Cookie.setCookieValue(a.cookies.session.name,void 0,d,a.cookies.session.domain,a.cookies.session.path),d},d}),c("Language",["Config","Helpers"],function(a,b){"use strict";var c={};return c.set=function(c){return-1!==a.supportedLanguages.indexOf(c)&&(b.Cookie.setCookieValue(a.cookies.skype.name,"LC",c,a.cookies.skype.domain,a.cookies.skype.path,a.cookies.skype.maxAge),!0)},c.get=function(){return b.Cookie.getCookieValue(a.cookies.skype.name,"LC")},c}),c("Config",[],function(){"use strict";var a={};return a.env="prod",a.timeout={offlineInvites:"10000"},a.clientVersion="30003/0.9999.0.0",a.supportedLanguages="en,ar,bg,cs,da,de,el,es,et,fi,fr,he,hi,hu,id,it,ja,ko,nl,no,pl,pt,pt-br,ro,ru,sv,tr,uk,zh-Hans,zh-Hant".split(","),a.urls={profile:"https://profile.skype.com/profile/v1/users/self/profile",eligibility:"https://join.skype.com/api/v1/browsers/eligible",botLogin:"https://login.skype.com/login?client_id=708557&redirect_uri=https%3A%2F%2Fjoin.skype.com%2Fbot%2F{BOT}%3Fadd",botInfo:"https://join.skype.com/api/v1/bots/info/",addBot:"https://join.skype.com/api/v1/bots/add/",threadInfo:"https://join.skype.com/api/v2/conversation/",inviteInfo:"https://join.skype.com/api/v2/offskypeinvites",guestUserInfo:"https://join.skype.com/api/v1/users/guests",addUserToThread:"https://join.skype.com/api/v1/adduser/",login:"https://login.skype.com/login?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com%2F%3FthreadId%3D{THREAD_ID}%26sessionId%3D{FLOW_ID}%26modality%3D{MODALITY}",logout:"https://login.skype.com/logout?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com%2F%3FthreadId%3D{THREAD_ID}%26sessionId%3D{FLOW_ID}",signup:"https://login.skype.com/join?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com%2F%3FthreadId%3D{THREAD_ID}%26sessionId%3D{FLOW_ID}",webClient:"https://web.skype.com/?threadId={THREAD_ID}&sessionId={FLOW_ID}&modality={MODALITY}",error:"https://join.skype.com/error",notFound:"https://join.skype.com/404",busy:"https://join.skype.com/busy",tooManyUsers:"https://join.skype.com/toomanyusers",joinDisabled:"https://join.skype.com/joindisabled",botNotFound:"https://join.skype.com/botnotfound",inviteNotFound:"https://join.skype.com/invitenotfound",captcha:"https://client.hip.live.com/GetHIP/GetWLSPHIP0/WLSPHIP0?mkt={LANGUAGE}&fid={FLOW_ID}&id=skypeguest&type=visual&rnd=",download:"https://go.skype.com/spaces.getskype",downloadAndoridSkypeLite:"https://go.skype.com/join.getskypelite",botHasTooManyContacts:"https://join.skype.com/bottoomanycontacts",telemetry:"https://join.skype.com/telemetry/aria",unsupported:"https://join.skype.com/unsupported",fingerprintCreate:"https://inviteconnector.skype.com/id/create",expired:"https://join.skype.com/expired",noInvite:"skype:?home&reason=noinvite",companyInfo:"https://join.skype.com/api/v1/company/",companyAddBot:"https://join.skype.com/api/v1/bots/add/",companyAddBotDirect:"https://pro.skype.com/v1/companies/{COMPANY}/customers",companyLogin:"https://login.skype.com/login?client_id=708557&redirect_uri=https%3A%2F%2Fjoin.skype.com%2Fpro%2F{COMPANY}%3Fadd",swcChat:"https://www.skype.com/en/test/ux/ver3/guest/"},a.silentLogin={webclient:{env:"live",client_id:"371752",redirect_uri:"https://join.skype.com",microsoft:!1},bot:{env:"live",client_id:"708557",redirect_uri:"https://join.skype.com",microsoft:!1}},a.cookies={skype:{name:"SC",path:"/",maxAge:7776e3,domain:".skype.com"},swc:{skypeToken:"skypeToken",threadId:"threadId",maxAge:86400,path:"/",domain:".skype.com"},session:{name:"launcher_session_id",path:"/",domain:"join.skype.com"},csrf:{name:"csrf_token"},offSkypeInvite:{name:"skypeInvite",key:"offSkypeInviteId",path:"/",maxAge:3600,domain:"join.skype.com"},offSkypeInviteType:{name:"skypeInviteType",key:"offSkypeInviteType",path:"/",maxAge:3600,domain:"join.skype.com"}},a.defaultModality="Chat",a.actions=["chat","call"],a.validReferrers=["slack","outlook","skypelite"],a.visitFlow={steps:{default:["VisitFlow/NativeClientLaunch","VisitFlow/JoinPrompt","VisitFlow/WebClientRedirect","VisitFlow/WebClientSignedIn","VisitFlow/WebClientGuest"],noGuest:["VisitFlow/NativeClientLaunch","VisitFlow/JoinPrompt","VisitFlow/WebClientRedirect"],noGuestCustom:["VisitFlow/NativeClientCustomLaunch","VisitFlow/JoinPromptCustomAction","VisitFlow/WebClientRedirect"],offSkypeInvites:["VisitFlow/NativeClientOffSkypeInviteLaunch","VisitFlow/JoinPromptOffSkypeInvitesAction","VisitFlow/WebClientRedirect"],offSkypeInvitesSetup:["VisitFlow/NativeClientOffSkypeInviteSetup"],bot:["VisitFlow/BotAddPrompt","VisitFlow/BotAdd","VisitFlow/BotLaunch","VisitFlow/BotAddSuccess"],company:["VisitFlow/CompanyAddPrompt","VisitFlow/CompanyAdd","VisitFlow/CompanyLaunch","VisitFlow/CompanyAddSuccess"]},params:{webOnly:{nativeLauncherDesktop:!1,joinPromptDesktop:!1},skipPrompt:{skipPrompt:!0},nativeOnly:{joinPromptStopsFlow:!0}}},a}),{OffSkypeInvitesLauncher:b("Pages/OffSkypeInvitesLauncher")}}();
